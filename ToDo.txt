Migrate remaining code from OCCocoa
